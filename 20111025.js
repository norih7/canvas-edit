var canvas;var stage;var p_bmp;var s_bmp;var p_container;var s_container;var t_container;var photo = new Image();var stamp = new Image();var stamp2 = new Image();	var fi = new Image();	var fi2 = new Image();var vx = 0;var shape;var i =0;function init() {	Ticker.addListener(window);		canvas = document.getElementById("canvas");	stage = new Stage(canvas);		if (Touch.isSupported()) { Touch.enable(stage); }		//スタンプ	stamp.onload = handleStampLoad;	stamp.src = "img/ok.png";		stamp2.onload = handleStampLoad;	stamp2.src = "img/ok02.png";		//写真初期設定	photo.onload = handlePhotoLoad;	photo.src = "./img/sample.jpg";			//文字	handleTextLoad();	//フレーム	fi.onload = handleFrameLoad;	fi.src = "./img/frame_01.png";		fi2.onload = handleFrameLoad;	fi2.src = "./img/frame_02.png";				var post =document.getElementById("post");post.onclick = function() {	var postimg = new Image();	postimg.src = canvas.toDataURL("image/png");		postimg.onload = function() {		location.href= postimg.src;	}}	}/*----------------------------------アニメーション----------------------------------*/function actionSlow(target) {			stage.tick = function() {			if ( target.y == 100 ) { 				target.y = 0;	 		}			vx = vx*0.6 + (-10-target.y)/5;			target.y += vx; 	   			this.update(); // 再描画 		};}function actionFast(target) {		stage.tick = function() {					if ( target.y == 100 ) { 				target.y = 0;		 	}			vx = vx*0.8 + (30-target.y)/5;			target.y += vx; 		    		this.update(); // 再描画  		};}function actionText(target,t) {		stage.tick = function() {					if ( target.y == 100 ) { 				target.y = 0;		 	}			vx = vx*0.8 + (30-target.y)/5;			target.y += vx; 			t.y +=vx;		    		this.update(); // 再描画  		};}function drag(target) {	target.onPress = function(ev){        // クリックされた位置        var clickX = ev.stageX;        var clickY = ev.stageY;        // クリックされた時点での左上座標        var startX = target.x;        var startY = target.y;				        // マウス移動イベント        ev.onMouseMove = function(move){                // container1をドラッグ移動させる                target.x = startX + move.stageX - clickX;                target.y = startY + move.stageY - clickY;                stage.update();        };	};}/*----------------------------------File API----------------------------------*/function preview(ele) {		if (!ele.files.length) return;	//ファイルが未選択の場合はreturn	var file = ele.files[0];	if (!/^image\/(png|jpeg|gif)$/.test(file.type)) return;	//MINEタイプをtypeプロパティで参照して、画像じゃないならreturn	var img = new Image();	var fr = new FileReader();	fr.readAsDataURL(file);  // 画像読み込み		fr.onload = function() {		img.src = fr.result;  // 読み込んだ画像データ(resultプロパティ)をsrcにセット		img.onload = handlePhotoLoad;	}}/*----------------------------------touch----------------------------------*//*----------------------------------写真----------------------------------*/function handlePhotoLoad(e) {	p_container=new Container();	p_container.x = 0;	p_container.y = 0;	p_container.mouseEnabled=true;		//一回消去	stage.removeAllChildren( );		photo = e.target;	p_bmp=new Bitmap(photo);	p_container.addChild(p_bmp);	p_bmp.x = 0;	p_bmp.y = 0;		stage.addChild(p_container);  	actionSlow(p_bmp);		//拡大	var plusbtn = document.getElementById("btn");	plusbtn.onclick = function() {		p_container.scaleX += 0.1;		p_container.scaleY += 0.1;		p_bmp.y = 0;		actionSlow(p_bmp);	}		//縮小	var minusbtn = document.getElementById("btn2");		minusbtn.onclick = function() {		p_container.scaleX -= 0.1;		p_container.scaleY -= 0.1;		p_bmp.y = 0;		actionSlow(p_bmp);	}		//ドラッグ処理	drag(p_container);	}/*----------------------------------スタンプ----------------------------------*/function handleStampLoad() {	s_container=new Container();	s_container.x = 15;	s_container.y = 0;	s_container.mouseEnabled=true;		//スタンプ消去	var del_stamp =document.getElementById("del_stamp");	del_stamp.onclick = function() {		s_container.removeAllChildren( );	}		//OKボタン	var ok = document.getElementById("ok");	ok.onclick = function() {		s_container.removeAllChildren( );				s_bmp=new Bitmap(stamp);		s_container.addChild(s_bmp);		stamp.x = 0;		stamp.y = 0;				stage.addChild(s_container); 		actionFast(s_bmp);	};		//いいねボタン	var sogood =document.getElementById("sogood");	sogood.onclick = function() {		s_container.removeAllChildren( );				s_bmp=new Bitmap(stamp2);		s_container.addChild(s_bmp);		stamp.x=0;		stamp.y = 0;				stage.addChild(s_container); 		actionFast(s_bmp);	}		//ドラッグ処理	drag(s_container);}/*----------------------------------文字入れ----------------------------------*/function handleTextLoad() {	i++;		t_container=new Container();	t_container.x = 25;	t_container.y = 300;	t_container.mouseEnabled=true;		//消去	var del_text =document.getElementById("del_text");	del_text.onclick = function() {		t_container.removeAllChildren( );	}		//	var text =document.getElementById("text");	text.onclick = function() {		t_container.removeAllChildren( );						var comstr = document.getElementById("comstr").value;		var t = new Text(comstr, "24px nukamiso", "#555");		t.x = 20;		t.y = 45;			    var g = new Graphics();		g.beginStroke("#555").setStrokeStyle(3).beginFill("#fff").moveTo(20 ,0);		g.quadraticCurveTo(0,0 , 0,20);		g.lineTo(0,50);		g.quadraticCurveTo(0,70,20,70);		g.lineTo(50,70);		g.quadraticCurveTo(50,80,40,85);		g.quadraticCurveTo(60,80,60,70);		g.lineTo(t.getMeasuredWidth ( ) + 15,70);		g.quadraticCurveTo((t.getMeasuredWidth ( ) + 15) + 20,70,(t.getMeasuredWidth ( ) + 15) + 20,50);		g.lineTo((t.getMeasuredWidth ( ) + 15) + 20, 20);		g.quadraticCurveTo((t.getMeasuredWidth ( ) + 15) + 20,0,(t.getMeasuredWidth ( ) + 15) ,0);		g.lineTo(20,0);		g.endStroke();						var shape1 = new Shape(g);		shape1.alpha = 0.8;		shape1.outline = true;		//shape1.shadow = new Shadow("#555", 0, 0, 5);		t_container.addChild(shape1);		t_container.addChild(t);		stage.addChild(t_container);		actionText(shape1,t);	 	}	//ドラッグ処理	drag(t_container);}/*----------------------------------フレーム----------------------------------*/function handleFrameLoad() {	f_container=new Container();	f_container.x = 0;	f_container.y = 0;		var frame_01 =document.getElementById("frame_01");	frame_01.onclick = function() {	f_container.removeAllChildren( );			var f_bmp=new Bitmap(fi);	f_container.addChild(f_bmp);		stage.addChild(f_container); 	stage.update();	 }	 	var frame_02 =document.getElementById("frame_02");	frame_02.onclick = function() {	f_container.removeAllChildren( );			var f_bmp=new Bitmap(fi2);	f_container.addChild(f_bmp);		stage.addChild(f_container); 	stage.update();	 }}/*----------------------------------投稿----------------------------------*//*----------------------------------tick----------------------------------*/function tick() {	stage.tick();	/*	if (update) {		update = false;		stage.update();	}	*/}/*-----------------------------------jQuery------------------------------------*/    var j$ = jQuery;          j$(function(){       j$("#accordion").each(function(){         j$("li > h2", this).each(function(index){           var $this = j$(this);                if(index > 0) $this.next().hide();                $this.click(function(){         var params = {height:"toggle", opacity:"toggle"};         j$(this).next().animate(params).parent().siblings()           .children("div:visible").animate(params);             return false;           });         });       });     }); 		//scrollfunction hideAdBar(){setTimeout("scrollTo(0,1)", 100);}